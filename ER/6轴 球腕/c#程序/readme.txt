c#代码未测试，仅作参考